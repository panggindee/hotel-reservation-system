var app=angular.module("app.main",[]);function controller(b,a,d,e,c){angular.extend(this,a("DefaultCtrl",{$scope:b}));b.data={};b.data.pax="";b.data.balancepax="";b.data.samefloor=1;b.filter={};b.filter.floor="";b.filter.as=1;b.filter.ad=1;b.filter.ae=1;b.filter.rs=1;b.filter.rd=1;b.filter.re=1;b.alerts=[];b.rooms=[];b.cart=[];if(d.localStorage.rooms===undefined){d.localStorage.clear();console.log("initialise the rooms");pk=0;b.rooms=[{id:pk++,floor:"1",rm:"101",type:"studio",pax:1,avail:1},{id:pk++,floor:"1",rm:"102",type:"studio",pax:1,avail:1},{id:pk++,floor:"1",rm:"103",type:"deluxe",pax:2,avail:1},{id:pk++,floor:"1",rm:"104",type:"deluxe",pax:2,avail:1},{id:pk++,floor:"1",rm:"105",type:"deluxe",pax:2,avail:1},{id:pk++,floor:"1",rm:"106",type:"deluxe",pax:2,avail:1},{id:pk++,floor:"1",rm:"107",type:"deluxe",pax:2,avail:1},{id:pk++,floor:"1",rm:"108",type:"executive",pax:4,avail:1},{id:pk++,floor:"1",rm:"109",type:"executive",pax:4,avail:1},{id:pk++,floor:"1",rm:"110",type:"executive",pax:4,avail:1},{id:pk++,floor:"2",rm:"201",type:"studio",pax:1,avail:1},{id:pk++,floor:"2",rm:"202",type:"studio",pax:1,avail:1},{id:pk++,floor:"2",rm:"203",type:"deluxe",pax:2,avail:1},{id:pk++,floor:"2",rm:"204",type:"deluxe",pax:2,avail:1},{id:pk++,floor:"2",rm:"205",type:"deluxe",pax:2,avail:1},{id:pk++,floor:"2",rm:"206",type:"deluxe",pax:2,avail:1},{id:pk++,floor:"2",rm:"207",type:"deluxe",pax:2,avail:1},{id:pk++,floor:"2",rm:"208",type:"executive",pax:4,avail:1},{id:pk++,floor:"2",rm:"209",type:"executive",pax:4,avail:1},{id:pk++,floor:"2",rm:"210",type:"executive",pax:4,avail:1},{id:pk++,floor:"3",rm:"301",type:"studio",pax:1,avail:1},{id:pk++,floor:"3",rm:"302",type:"studio",pax:1,avail:1},{id:pk++,floor:"3",rm:"303",type:"deluxe",pax:2,avail:1},{id:pk++,floor:"3",rm:"304",type:"deluxe",pax:2,avail:1},{id:pk++,floor:"3",rm:"305",type:"deluxe",pax:2,avail:1},{id:pk++,floor:"3",rm:"306",type:"deluxe",pax:2,avail:1},{id:pk++,floor:"3",rm:"307",type:"deluxe",pax:2,avail:1},{id:pk++,floor:"3",rm:"308",type:"executive",pax:4,avail:1},{id:pk++,floor:"3",rm:"309",type:"executive",pax:4,avail:1},{id:pk++,floor:"3",rm:"310",type:"executive",pax:4,avail:1},{id:pk++,floor:"4",rm:"401",type:"studio",pax:1,avail:1},{id:pk++,floor:"4",rm:"402",type:"studio",pax:1,avail:1},{id:pk++,floor:"4",rm:"403",type:"deluxe",pax:2,avail:1},{id:pk++,floor:"4",rm:"404",type:"deluxe",pax:2,avail:1},{id:pk++,floor:"4",rm:"405",type:"deluxe",pax:2,avail:1},{id:pk++,floor:"4",rm:"406",type:"deluxe",pax:2,avail:1},{id:pk++,floor:"4",rm:"407",type:"deluxe",pax:2,avail:1},{id:pk++,floor:"4",rm:"408",type:"executive",pax:4,avail:1},{id:pk++,floor:"4",rm:"409",type:"executive",pax:4,avail:1},{id:pk++,floor:"4",rm:"410",type:"executive",pax:4,avail:1},{id:pk++,floor:"5",rm:"501",type:"studio",pax:1,avail:1},{id:pk++,floor:"5",rm:"502",type:"studio",pax:1,avail:1},{id:pk++,floor:"5",rm:"503",type:"deluxe",pax:2,avail:1},{id:pk++,floor:"5",rm:"504",type:"deluxe",pax:2,avail:1},{id:pk++,floor:"5",rm:"505",type:"deluxe",pax:2,avail:1},{id:pk++,floor:"5",rm:"506",type:"deluxe",pax:2,avail:1},{id:pk++,floor:"5",rm:"507",type:"deluxe",pax:2,avail:1},{id:pk++,floor:"5",rm:"508",type:"executive",pax:4,avail:1},{id:pk++,floor:"5",rm:"509",type:"executive",pax:4,avail:1},{id:pk++,floor:"5",rm:"510",type:"executive",pax:4,avail:1},];d.localStorage.rooms=JSON.stringify(b.rooms)}else{console.log("loading rooms from local storage");b.rooms=$.parseJSON(d.localStorage.rooms)}b.filterRule=function(f){return b.data.balancepax===""||b.data.balancepax>0&&(b.data.balancepax<=f||b.data.balancepax>4)};b.filterFloor=function(f){return(b.filter.floor==""||b.filter.floor==f)};b.updatePax=function(){b.data.balancepax=b.data.pax;b.cart=[]};b.updateFloor=function(){if(!b.data.samefloor){b.filter.floor=""}else{if(b.cart[0]!=undefined){b.filter.floor=b.rooms[b.cart[0]].floor}}};b.addToCart=function(f){if(b.cart.indexOf(f)==-1&&b.data.balancepax>0){b.cart.push(f);b.data.balancepax-=b.rooms[f].pax;b.data.balancepax=(b.data.balancepax<0)?0:b.data.balancepax;if(b.data.samefloor){b.filter.floor=b.rooms[f].floor}b.alerts=[];b.cart.sort()}};b.notInCart=function(f){return(b.cart.indexOf(f)==-1)};b.removeFromCart=function(f){b.cart.splice(b.cart.indexOf(f),1);b.data.balancepax+=b.rooms[f].pax;updateFloor();b.alerts=[];b.cart.sort()};b.checkOutCart=function(){if(b.data.balancepax==0){angular.forEach(b.cart,function(f){b.rooms[f].avail=0});d.localStorage.rooms=JSON.stringify(b.rooms);b.cart=[]}else{b.alerts.push({type:"alert radius",msg:"Unable to accomodate all pax"})}};b.cancelReservation=function(f){b.rooms[f].avail=1;d.localStorage.rooms=JSON.stringify(b.rooms)};b.closeAlert=function(f){b.alerts.splice(f,1)};b.intialise=function(){d.localStorage.clear();d.location.reload()}}controller.$inject=["$scope","$controller","$window","$http","CommonService"];app.controller("LandingCtrl",controller);